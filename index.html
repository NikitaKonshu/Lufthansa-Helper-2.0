<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lufthansa Helper — splash video → login → optional tour</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg-top:#031127; --bg-bot:#072b3a;
  --muted:#9fc0d8; --text:#eaf4ff;
  --accent-yellow:#ffd54a;
  font-family:Inter,system-ui,Arial,sans-serif;
  font-size:15px;
}

/* reset */
*{box-sizing:border-box}
html,body{height:100%;margin:0}
body{
  margin:0;padding:0;
  background:linear-gradient(180deg,var(--bg-top),var(--bg-bot));
  color:var(--text); -webkit-font-smoothing:antialiased;
  min-height:100vh;
}

/* app root */
.app-root{ display:flex; justify-content:center; align-items:flex-start; padding:18px; min-height:100vh; }

/* hero card (liquid glass) */
.container{width:100%;max-width:1280px}
.hero{
  border-radius:16px;padding:16px;
  margin-top:28px;
  background:linear-gradient(180deg, rgba(255,255,255,0.035), rgba(2,8,18,0.06));
  border:1px solid rgba(255,255,255,0.05);
  box-shadow: 0 36px 120px rgba(2,8,18,0.7), inset 0 2px 0 rgba(255,255,255,0.02);
  backdrop-filter: blur(12px) saturate(120%);
}

/* header */
.header{display:flex;justify-content:space-between;align-items:center;gap:12px}
.brand{display:flex;gap:12px;align-items:center;min-width:0}
.logo{width:60px;height:60px;border-radius:14px;background:linear-gradient(180deg,#0a3b3f,#042a2e);display:flex;align-items:center;justify-content:center;font-weight:900;color:var(--accent-yellow);font-size:18px}
.title{font-weight:900}
.subtitle{font-size:13px;color:var(--muted)}

/* compact controls reused from before */
.btn-neutral{ padding:8px 12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.06);color:var(--text);font-weight:700;cursor:pointer}
.btn-primary{ padding:10px 14px;border-radius:12px;background:linear-gradient(180deg,var(--accent-yellow),#ffbf3a);border:1px solid rgba(0,0,0,0.08);color:#072022;font-weight:900;cursor:pointer}

/* splash (full-screen) */
.splash-back{
  position:fixed; inset:0; z-index:10050;
  display:flex; align-items:center; justify-content:center;
  background: linear-gradient(180deg, rgba(2,6,14,0.88), rgba(2,6,20,0.92));
  backdrop-filter: blur(6px) saturate(0.9);
}
.splash-card{
  width:100%; max-width:1150px; height:60vh; border-radius:16px; overflow:hidden; display:flex;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
  border: 1px solid rgba(255,255,255,0.04); box-shadow: 0 50px 140px rgba(0,0,0,0.7);
}
.splash-media{ width:60%; position:relative; display:flex; align-items:center; justify-content:center; background:#000; overflow:hidden; }
#yt-player{ width:100%; height:100%; }
.splash-overlay{
  position:absolute; inset:0; display:flex; flex-direction:column; align-items:flex-start; justify-content:flex-end; padding:28px;
  background: linear-gradient(180deg, rgba(0,0,0,0) 40%, rgba(0,0,0,0.5));
}
.splash-cta-big{
  background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  border-radius:12px; padding:18px 22px; color:#fff; font-weight:800; font-size:20px; display:flex; gap:12px; align-items:center;
  box-shadow: 0 18px 46px rgba(0,0,0,0.5);
}
.splash-cta-big .primary{
  margin-left:auto; background:linear-gradient(180deg,var(--accent-yellow),#ffbf3a); color:#072022; padding:10px 16px; border-radius:10px; font-weight:900; cursor:pointer;
}
.splash-cta-small{ margin-top:8px; color:var(--muted); font-size:13px; }

/* right panel */
.splash-info{ width:40%; padding:26px; display:flex; flex-direction:column; gap:14px; justify-content:center; }
.splash-info h1{ margin:0;font-size:24px; font-weight:900; color:var(--text) }
.splash-info p{ margin:0;color:var(--muted) }

/* login modal */
.modal-back{ display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; z-index:10100; }
.modal{ width:420px;padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.04)); border:1px solid rgba(255,255,255,0.03); box-shadow:0 30px 80px rgba(0,0,0,0.6); }
.input{ width:100%; padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:var(--text) }
.row{ display:flex; gap:8px; align-items:center; margin-top:10px }
.small{ font-size:13px; color:var(--muted) }

/* tour overlay (optional) */
.tour-back{ display:none; position:fixed; inset:0; z-index:10150; align-items:center; justify-content:center; background: linear-gradient(180deg, rgba(2,6,14,0.84), rgba(2,6,20,0.9)); }
.tour-card{ width:92%; max-width:760px; border-radius:14px; padding:20px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.03)); border:1px solid rgba(255,255,255,0.04); }

/* responsive */
@media(max-width:900px){
  .splash-card{ flex-direction:column; height:56vh; }
  .splash-media, #yt-player { width:100%; height:220px; }
  .splash-info{ width:100%; padding:14px; }
}
</style>
</head>
<body>
<div id="appRoot" class="app-root">
  <div class="container">
    <div id="appHero" class="hero">
      <div class="header">
        <div class="brand">
          <div class="logo">LH</div>
          <div>
            <div class="title">Lufthansa Helper</div>
            <div class="subtitle">усиленное LED · liquid glass · демонстрация</div>
          </div>
        </div>
        <div style="display:flex;gap:10px;align-items:center">
          <div id="sessionBadge" class="small">Неавторизован</div>
          <button id="openGateBtn" class="btn-neutral">Вход</button>
        </div>
      </div>

      <!-- основной контент оставлен упрощённым -->
      <div style="padding:18px;color:var(--muted)">Интерфейс приложения загрузится после входа.</div>
    </div>
  </div>
</div>

<!-- splash with YouTube and big CTA resembling image overlay -->
<div id="splash" class="splash-back" style="display:flex;">
  <div class="splash-card" role="dialog" aria-modal="true">
    <div class="splash-media" id="splashMedia">
      <div id="yt-player"></div>
      <div class="splash-overlay" aria-hidden="false">
        <div class="splash-cta-big" role="button" aria-label="Дальше">
          <div style="display:flex;flex-direction:column;align-items:flex-start">
            <div style="font-size:22px;font-weight:900;color:#fff">Sound makes it home</div>
            <div class="splash-cta-small">Geschenke kaufen</div>
          </div>
          <button id="splashContinue" class="primary">Дальше</button>
        </div>
      </div>
    </div>
    <div class="splash-info">
      <h1>Добро пожаловать</h1>
      <p>Просмотрите короткий ролик. Нажмите «Дальше», чтобы продолжить вход в систему.</p>
      <div style="display:flex;gap:10px">
        <button id="btnSkipVideo" class="btn-neutral">Пропустить видео</button>
        <button id="btnOpenLogin" class="btn-primary">Вход</button>
      </div>
    </div>
  </div>
</div>

<!-- login modal (появляется после сшипа или по кнопке) -->
<div id="gateModal" class="modal-back" style="display:none;">
  <div class="modal" role="dialog" aria-modal="true" aria-label="Вход">
    <div style="font-weight:900">Вход в систему</div>
    <div class="small" style="margin-top:8px">Введите позывной и пароль. Кодовое слово: <strong>quickaccess2025</strong></div>

    <div class="row">
      <input id="loginCall" class="input" placeholder="Позывной (callSign)" />
    </div>
    <div class="row">
      <input id="loginPass" class="input" placeholder="Пароль или кодовое слово" type="password" />
    </div>

    <div class="row" style="align-items:center;margin-top:12px">
      <input id="tourAfterLogin" type="checkbox" checked />
      <label for="tourAfterLogin" class="small" style="margin-left:6px">Показать инструкцию после входа</label>
    </div>

    <div style="display:flex;justify-content:space-between;gap:8px;margin-top:14px;align-items:center">
      <div style="display:flex;gap:8px">
        <button id="btnDemoQuick" class="btn-neutral" title="Быстрый вход (демо)">Быстрый вход</button>
      </div>
      <div style="display:flex;gap:8px">
        <button id="btnLogin" class="btn-primary">Войти</button>
      </div>
    </div>
  </div>
</div>

<!-- optional tour overlay -->
<div id="tour" class="tour-back" style="display:none;">
  <div class="tour-card" role="dialog" aria-modal="true" aria-label="Инструкция для пилотов">
    <div style="display:flex;flex-direction:column;gap:12px">
      <div style="font-weight:900;font-size:18px">Краткая инструкция</div>
      <div style="color:var(--muted)">1. Выберите авиакомпанию в списке; 2. Выберите интервал времени; 3. Нажмите СГЕНЕРИРОВАТЬ и подтвердите бронь.</div>
      <div style="display:flex;justify-content:flex-end;gap:8px">
        <button id="tourSkip" class="btn-neutral">Пропустить инструкцию</button>
        <button id="tourDone" class="btn-primary">Готово</button>
      </div>
    </div>
  </div>
</div>

<!-- YouTube IFrame API -->
<script src="https://www.youtube.com/iframe_api"></script>

<script>
/* ========== SETTINGS ========== */
const YT_VIDEO_ID = '7S7smPw9EiE'; // ваш ролик
const YT_AUTOMUTE = 1;             // 1 = mute для автоплея
let ytPlayer = null;

/* ========== DOM refs ========== */
const splash = document.getElementById('splash');
const splashContinue = document.getElementById('splashContinue');
const btnSkipVideo = document.getElementById('btnSkipVideo');
const btnOpenLogin = document.getElementById('btnOpenLogin');
const gateModal = document.getElementById('gateModal');
const btnLogin = document.getElementById('btnLogin');
const btnDemoQuick = document.getElementById('btnDemoQuick');
const loginCall = document.getElementById('loginCall');
const loginPass = document.getElementById('loginPass');
const tourOverlay = document.getElementById('tour');
const tourAfterLogin = document.getElementById('tourAfterLogin');
const tourSkip = document.getElementById('tourSkip');
const tourDone = document.getElementById('tourDone');
const openGateBtn = document.getElementById('openGateBtn');
const sessionBadge = document.getElementById('sessionBadge');

/* demo pilots (упрощённо) */
const PILOTS = [
  {id:'pilot_ivan',name:'Ivan Petrov',callSign:'IPET',verified:true,password:''},
  {id:'pilot_loui',name:'Loui Desulier',callSign:'FRENCH',verified:true,password:'louiSecret'}
];
let SESSION = { pilotId: null };

/* ========== YouTube player init ========== */
function onYouTubeIframeAPIReady() {
  try {
    ytPlayer = new YT.Player('yt-player', {
      videoId: YT_VIDEO_ID,
      playerVars: {
        autoplay: 1,
        controls: 0,
        modestbranding: 1,
        rel: 0,
        mute: YT_AUTOMUTE,
        playsinline: 1,
        enablejsapi: 1,
        loop: 1,
        playlist: YT_VIDEO_ID,
        start: 40,
        iv_load_policy: 3
      },
      events: {
        onReady: function(e){
          try { e.target.playVideo(); } catch(err) {}
        },
        onStateChange: function(e){
          // если видео закончилось (в теории loop = 1 предотвратит это), можно реагировать
          if(e.data === YT.PlayerState.ENDED){
            // ничего не делаем, оно зациклено
          }
        }
      }
    });
  } catch(err) {
    // если что-то не так — оставляем fallback (в этом простом варианте fallback не реализован отдельно)
  }
}

/* ========== Splash -> Login -> Optional Tour flow ========== */

function openLoginModal(){
  gateModal.style.display = 'flex';
}
function closeLoginModal(){
  gateModal.style.display = 'none';
}

/* 1) События на splash */
splashContinue.addEventListener('click', ()=> {
  try { if(ytPlayer && ytPlayer.pauseVideo) ytPlayer.pauseVideo(); }catch(e){}
  splash.style.display = 'none';
  openLoginModal();
});
btnSkipVideo.addEventListener('click', ()=> {
  try { if(ytPlayer && ytPlayer.stopVideo) ytPlayer.stopVideo(); }catch(e){}
  splash.style.display = 'none';
  openLoginModal();
});
btnOpenLogin.addEventListener('click', ()=> {
  try { if(ytPlayer && ytPlayer.stopVideo) ytPlayer.stopVideo(); }catch(e){}
  splash.style.display = 'none';
  openLoginModal();
});

/* 2) Login handlers */
btnLogin.addEventListener('click', ()=> {
  const cs = (loginCall.value||'').trim();
  const pass = (loginPass.value||'').trim();
  if(!cs){ alert('Введите позывной'); return; }
  const p = PILOTS.find(x=> (x.callSign||'').toLowerCase() === cs.toLowerCase());
  if(!p){ alert('Пилот не найден'); return; }
  // пароли: либо кодовое слово quickaccess2025, либо индивидуальный пароль
  if(pass === 'quickaccess2025' || (p.password && pass === p.password)){
    SESSION.pilotId = p.id;
    renderSession();
    closeLoginModal();
    // показать тур если пользователь разрешил
    if(tourAfterLogin.checked){
      showTour();
    } else {
      // продолжить в приложении (ничего — demo)
      console.info('Login complete, tour skipped');
    }
  } else {
    alert('Неверный пароль');
  }
});

btnDemoQuick.addEventListener('click', ()=>{
  const cs = (loginCall.value||'').trim();
  if(!cs){ alert('Введите позывной для быстрого входа'); return; }
  const p = PILOTS.find(x=> (x.callSign||'').toLowerCase() === cs.toLowerCase());
  if(!p){ alert('Пилот не найден'); return; }
  loginPass.value = 'quickaccess2025';
  btnLogin.click();
});

openGateBtn.addEventListener('click', ()=> {
  openLoginModal();
});

/* render session badge */
function renderSession(){
  if(SESSION.pilotId){
    const p = PILOTS.find(x=>x.id === SESSION.pilotId) || {};
    sessionBadge.textContent = p.callSign ? `Вошёл ${p.callSign}` : 'Вошёл';
  } else {
    sessionBadge.textContent = 'Неавторизован';
  }
}

/* 3) Tour handlers */
function showTour(){ tourOverlay.style.display = 'flex'; }
function hideTour(){ tourOverlay.style.display = 'none'; }

tourSkip.addEventListener('click', ()=> {
  tourOverlay.style.display = 'none';
});
tourDone.addEventListener('click', ()=> {
  tourOverlay.style.display = 'none';
});

/* small safety: element refs used in tour */
const tourOverlay = document.getElementById('tour');

/* init: show splash on load */
(function init(){
  renderSession();
  // show splash by default
  splash.style.display = 'flex';
  // ensure login modal hidden initially
  gateModal.style.display = 'none';
  tourOverlay.style.display = 'none';
  // slight fallback: if YT doesn't initialize, keep splash showing and allow manual "Вход"
  setTimeout(()=> {
    if(!ytPlayer){
      // nothing else to do — user can press "Вход"
      console.warn('YouTube player not ready yet');
    }
  }, 1200);
})();
</script>
</body>
</html>
