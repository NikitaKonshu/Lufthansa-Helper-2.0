<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fleet — airlines colored grid</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg-1:#041426; --bg-2:#072b3a;
  --glass-1: rgba(255,255,255,0.03);
  --muted:#9fc0d8; --text:#eaf4ff;
  --accent:#ffd54a;
  font-family:Inter,system-ui,Arial,sans-serif;
  font-size:15px;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0}
body{
  min-width:0;
  margin:0;padding:18px;
  background:linear-gradient(180deg,var(--bg-1),var(--bg-2));
  color:var(--text); -webkit-font-smoothing:antialiased;
  display:flex;justify-content:center;align-items:flex-start;
}
.container{width:100%;max-width:1200px}
.header{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:12px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);backdrop-filter:blur(8px)}
.brand{display:flex;gap:12px;align-items:center}
.logo{width:50px;height:50px;border-radius:10px;background:linear-gradient(180deg,#083a3f,#04292e);display:flex;align-items:center;justify-content:center;font-weight:900;color:var(--accent)}
.title{font-weight:800}
.subtitle{font-size:13px;color:var(--muted)}

/* tabs */
.tabs{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
.tab{padding:8px 12px;border-radius:10px;background:transparent;color:var(--text);font-weight:700;cursor:pointer}
.tab.active{transform:translateY(-3px)}

/* controls */
.controls{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-top:12px}
.controls .left{display:flex;gap:12px;align-items:center;min-width:0}
.controls .right{margin-left:auto;display:flex;gap:8px;align-items:center}

/* search */
.search{padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text);min-width:220px}

/* durations pills */
.durations{display:flex;gap:8px;flex-wrap:wrap}
.pill{position:relative;display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);font-weight:700;cursor:pointer;color:var(--text)}
.pill.small{padding:6px 10px;font-size:13px}
.pill.active{transform:translateY(-4px);box-shadow:0 18px 40px rgba(0,0,0,0.5)}

/* airline grid (responsive) */
.airline-grid{
  margin-top:12px;
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap:10px;
  align-items:start;
  width:100%;
  min-width:0;
  max-height:360px;
  overflow:auto;
  padding:8px;
  border-radius:12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02));
  border:1px solid rgba(255,255,255,0.03);
}

/* airline card/pill */
.airline{
  position:relative;
  display:flex;
  gap:12px;
  align-items:center;
  padding:10px;
  border-radius:12px;
  background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(0,0,0,0.03));
  border:1px solid rgba(255,255,255,0.02);
  cursor:pointer;
  min-width:0;
  overflow:hidden;
}
.airline .dot{
  width:14px;height:14px;border-radius:50%;flex:0 0 14px;border:2px solid rgba(255,255,255,0.06);
}
.airline .meta{min-width:0}
.airline .name{font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.airline .code{font-size:12px;color:var(--muted)}

/* LED glow layer behind each airline (use inline style for color) */
.airline::before{
  content:'';
  position:absolute;
  left:50%; top:50%;
  width:220%; height:86%;
  transform:translate(-50%,-50%) scale(0.96);
  border-radius:16px;
  z-index:0;
  filter:blur(28px) saturate(140%);
  opacity:0;
  pointer-events:none;
  transition:opacity .18s, transform .18s;
  mix-blend-mode:screen;
}
.airline:hover::before{ opacity:0.22; transform:translate(-50%,-50%) scale(1.04); }
.airline.active::before{ opacity:0.42; transform:translate(-50%,-50%) scale(1.02); }

/* ensure text above glow */
.airline > *{ position:relative; z-index:2 }

/* layout for main area */
.layout{display:grid;grid-template-columns:1fr 380px;gap:14px;margin-top:12px}
@media(max-width:1000px){ .layout{grid-template-columns:1fr} }

/* small lists */
.route-list, .fleet-list{display:flex;flex-direction:column;gap:8px;margin-top:12px;min-width:0}
.route-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(0,0,0,0.02));border:1px solid rgba(255,255,255,0.02);cursor:pointer;min-width:0}
.kv{color:var(--muted);font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

/* avoid horizontal overflow */
*{word-break:break-word}
</style>
</head>
<body>
<div class="container">
  <header class="header">
    <div class="brand">
      <div class="logo">LH</div>
      <div>
        <div class="title">Lufthansa Helper</div>
        <div class="subtitle">Airlines — colored grid</div>
      </div>
    </div>
    <div style="display:flex;gap:10px;align-items:center">
      <div id="sessionBadge" class="kv">Неавторизован</div>
      <button id="openGate" class="pill small">Войти</button>
    </div>
  </header>

  <div class="tabs">
    <div id="tabGenerate" class="tab active">Генерация</div>
    <div id="tabRoutes" class="tab">Направления</div>
    <div id="tabFleet" class="tab">Флот</div>
  </div>

  <div class="controls">
    <div class="left">
      <input id="airSearch" class="search" placeholder="Поиск авиакомпании или кода" />
      <div style="display:flex;gap:8px;align-items:center">
        <strong class="kv" style="margin-right:6px">Время</strong>
        <div id="durations" class="durations"></div>
      </div>
    </div>

    <div class="right">
      <button id="clearFilter" class="pill small">Сброс</button>
      <button id="generateBtn" class="pill">Сгенерировать</button>
    </div>
  </div>

  <!-- airline grid -->
  <div id="airGrid" class="airline-grid" aria-live="polite"></div>

  <div class="layout">
    <main>
      <section class="card" style="padding:12px">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:900">Направления</div>
          <div class="kv">Выберите направление</div>
        </div>
        <div id="routes" class="route-list"></div>
      </section>
    </main>

    <aside>
      <div class="card" style="padding:12px;margin-bottom:12px">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:900">Флот</div>
          <div class="kv">Списком</div>
        </div>
        <div id="fleet" class="fleet-list"></div>
      </div>

      <div class="card" style="padding:12px">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:900">Журнал</div>
          <div><button id="openGate2" class="pill small">Вход</button></div>
        </div>
        <div id="log" class="kv" style="margin-top:8px;max-height:300px;overflow:auto">Пусто</div>
      </div>
    </aside>
  </div>
</div>

<script>
/* ========== Data ========== */
const DURATIONS = [
  {label:"1–2ч",min:60,max:120},
  {label:"2–3ч",min:120,max:180},
  {label:"3–4ч",min:180,max:240},
  {label:"5–6ч",min:300,max:360},
  {label:"6–7ч",min:360,max:420},
  {label:"7–8ч",min:420,max:480},
  {label:"8–9ч",min:480,max:540},
  {label:"9–10ч",min:540,max:600},
  {label:"10+ч",min:600,max:99999}
];

/* Airlines list with explicit colors (unique) */
const AIRLINES = [
  {name:"Lufthansa",code:"LH",color:"#1E6FFF"},
  {name:"Swiss International Air Lines",code:"LX",color:"#D81E5B"},
  {name:"Austrian Airlines",code:"OS",color:"#DA291C"},
  {name:"AirBaltic",code:"BT",color:"#00A99D"},
  {name:"Brussels Airlines",code:"SN",color:"#003399"},
  {name:"Eurowings",code:"EW",color:"#8A4BFF"},
  {name:"Discover Airlines",code:"DH",color:"#F07F2A"},
  {name:"Edelweiss Air",code:"WK",color:"#FF7BAC"},
  {name:"Lufthansa Cargo",code:"G0",color:"#0A63D6"},
  {name:"Lufthansa CityLine",code:"CL",color:"#2D6DE6"},
  {name:"Lufthansa Technik",code:"LT",color:"#2D6DE6"},
  {name:"Air Dolomiti",code:"EN",color:"#00A1DE"},
  {name:"Lufthansa Private Jet",code:"PJ",color:"#0a5fb0"},
  {name:"ITA Airways",code:"AZ",color:"#0067B1"},
  {name:"Widerøe",code:"WF",color:"#00A651"},
  {name:"Norwegian Airlines",code:"DY",color:"#BA0C2F"},
  {name:"Finnair",code:"AY",color:"#003366"},
  {name:"SAS Scandinavian Airlines",code:"SK",color:"#003A63"},
  {name:"Condor",code:"DE",color:"#FFD200"},
  {name:"AeroLogic",code:"3S",color:"#8A8D8F"},
  {name:"SunExpress",code:"SX",color:"#FF8A3D"}
];

/* Demo routes and fleet (small) */
const ROUTES = [
  {airline:"Lufthansa",fromICAO:"EDDF",toICAO:"ENGM",fromCity:"Frankfurt",toCity:"Oslo",durationMinutes:120},
  {airline:"Swiss International Air Lines",fromICAO:"EDDF",toICAO:"LSZH",fromCity:"Frankfurt",toCity:"Zurich",durationMinutes:60},
  {airline:"SunExpress",fromICAO:"EDDF",toICAO:"LTAI",fromCity:"Frankfurt",toCity:"Antalya",durationMinutes:180},
  {airline:"Condor",fromICAO:"EDDF",toICAO:"KJFK",fromCity:"Frankfurt",toCity:"New York",durationMinutes:480}
];

let FLEET = [
  {id:"LH-A320-01",airline:"Lufthansa",type:"A320",seats:180,locationICAO:"EDDF",status:"idle",maxFlightMinutes:240,fuelMinutes:400},
  {id:"LX-A320-01",airline:"Swiss International Air Lines",type:"A320",seats:180,locationICAO:"EDDF",status:"idle",maxFlightMinutes:300,fuelMinutes:420},
  {id:"DE-B767-01",airline:"Condor",type:"B767",seats:250,locationICAO:"EDDF",status:"idle",maxFlightMinutes:720,fuelMinutes:800}
];

/* state */
let chosenAirline = null; // airline name
let chosenDuration = null; // index into DURATIONS
let searchQuery = '';

/* ========= DOM refs ========= */
const airGrid = document.getElementById('airGrid');
const durWrap = document.getElementById('durations');
const airSearch = document.getElementById('airSearch');
const routesWrap = document.getElementById('routes');
const fleetWrap = document.getElementById('fleet');
const logEl = document.getElementById('log');

/* ========= Render helpers ========= */
function renderDurations(){
  durWrap.innerHTML = '';
  DURATIONS.forEach((d,i)=>{
    const b = document.createElement('button');
    b.className = 'pill small';
    b.textContent = d.label;
    b.dataset.idx = i;
    if(chosenDuration === i) b.classList.add('active');
    b.addEventListener('click', ()=>{
      if(chosenDuration === i) chosenDuration = null; else chosenDuration = i;
      updateActiveState();
      renderAllLists();
    });
    durWrap.appendChild(b);
  });
}

function matchesSearch(a){
  if(!searchQuery) return true;
  const q = searchQuery.toLowerCase();
  return a.name.toLowerCase().includes(q) || (a.code && a.code.toLowerCase().includes(q));
}

function renderAirGrid(){
  airGrid.innerHTML = '';
  const filtered = AIRLINES.filter(matchesSearch);
  filtered.forEach(a=>{
    const card = document.createElement('div');
    card.className = 'airline';
    // set glow color on pseudo via inline CSS custom property
    card.style.setProperty('--led-color', a.color);
    // we set ::before background by applying background via style attribute on element's style (used below)
    // create dot and labels
    const dot = document.createElement('div'); dot.className='dot'; dot.style.background = a.color;
    const meta = document.createElement('div'); meta.className='meta';
    const name = document.createElement('div'); name.className='name'; name.textContent = a.name;
    const code = document.createElement('div'); code.className='code'; code.textContent = a.code || '';
    meta.appendChild(name); meta.appendChild(code);
    card.appendChild(dot); card.appendChild(meta);

    // apply LED glow color via inline style on ::before using CSS custom property by injecting a style rule into element
    // browsers don't allow setting pseudo-element styles directly; create an inner style tag unique for this card
    const glow = `radial-gradient(60% 60% at 50% 40%, ${a.color}cc 0%, ${a.color}88 8%, transparent 46%)`;
    card.style.backgroundImage = 'linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02))';
    // Workaround: set box-shadow as soft glow using color when hovered/active
    card.addEventListener('mouseenter', ()=> card.style.boxShadow = `0 8px 36px ${hexToRgba(a.color,0.22)}, inset 0 1px 0 rgba(255,255,255,0.02)`);
    card.addEventListener('mouseleave', ()=> card.style.boxShadow = `0 6px 18px rgba(0,0,0,0.25), inset 0 1px 0 rgba(255,255,255,0.02)`);
    // clicking selects airline
    card.addEventListener('click', ()=>{
      if(chosenAirline === a.name) chosenAirline = null; else chosenAirline = a.name;
      updateActiveState();
      renderAllLists();
    });

    // mark active
    if(chosenAirline === a.name) card.classList.add('active'); else card.classList.remove('active');

    // set inline before-like glow by using filter on a child overlay instead of pseudo
    const overlay = document.createElement('div');
    overlay.style.position = 'absolute';
    overlay.style.left = '50%';
    overlay.style.top = '50%';
    overlay.style.transform = 'translate(-50%,-50%) scale(0.98)';
    overlay.style.width = '220%';
    overlay.style.height = '86%';
    overlay.style.borderRadius = '16px';
    overlay.style.zIndex = '0';
    overlay.style.pointerEvents = 'none';
    overlay.style.opacity = (chosenAirline===a.name) ? '0.42' : '0';
    overlay.style.filter = 'blur(28px) saturate(140%)';
    overlay.style.mixBlendMode = 'screen';
    overlay.style.background = glow;
    overlay.dataset.overlay = '1';
    card.appendChild(overlay);

    // ensure contents above overlay
    dot.style.zIndex = 2; meta.style.zIndex = 2;

    airGrid.appendChild(card);
  });
  // ensure grid never overflows horizontally (CSS handles it). If many items, grid will wrap or scroll vertically.
}

function renderRoutes(){
  routesWrap.innerHTML = '';
  const list = ROUTES.filter(r=>{
    if(chosenAirline && r.airline !== chosenAirline) return false;
    if(chosenDuration !== null){
      const d = DURATIONS[chosenDuration];
      if(!(r.durationMinutes >= d.min && r.durationMinutes <= d.max)) return false;
    }
    return true;
  });
  if(!list.length){ routesWrap.innerHTML = '<div class="kv">Нет направлений</div>'; return; }
  list.forEach(r=>{
    const row = document.createElement('div'); row.className='route-item';
    row.innerHTML = `<div style="min-width:0"><div style="font-weight:800">${escapeHtml(r.fromICAO)} → ${escapeHtml(r.toICAO)}</div><div class="kv">${escapeHtml(r.fromCity)} → ${escapeHtml(r.toCity)} · ${escapeHtml(r.airline)}</div></div><div class="kv">${r.durationMinutes} мин</div>`;
    routesWrap.appendChild(row);
  });
}

function renderFleet(){
  fleetWrap.innerHTML = '';
  const filtered = FLEET.filter(a=>{
    if(chosenAirline && a.airline !== chosenAirline) return false;
    if(chosenDuration !== null){
      const d = DURATIONS[chosenDuration];
      if(a.maxFlightMinutes < d.min) return false;
    }
    return true;
  });
  if(!filtered.length){ fleetWrap.innerHTML = '<div class="kv">Нет самолётов</div>'; return; }
  filtered.forEach(a=>{
    const div = document.createElement('div'); div.className='route-item';
    const percent = Math.min(100, Math.round((a.fuelMinutes / Math.max(a.maxFlightMinutes,300)) * 100));
    div.innerHTML = `<div style="min-width:0"><div style="font-weight:800">${escapeHtml(a.id)}</div><div class="kv">${escapeHtml(a.airline)} · ${escapeHtml(a.type)} · ${escapeHtml(a.locationICAO)}</div></div><div class="kv">${percent}% · ${a.fuelMinutes} мин</div>`;
    fleetWrap.appendChild(div);
  });
}

/* ========= Utility ========= */
function updateActiveState(){
  // update grid active classes and overlays
  Array.from(airGrid.children).forEach(card=>{
    const name = card.querySelector('.name')?.textContent;
    const overlay = card.querySelector('[data-overlay]');
    if(name === chosenAirline){
      card.classList.add('active');
      if(overlay) overlay.style.opacity = '0.42';
    } else {
      card.classList.remove('active');
      if(overlay) overlay.style.opacity = '0';
    }
  });
  // update durations active look
  Array.from(durWrap.children).forEach(btn=>{
    const idx = Number(btn.dataset.idx);
    btn.classList.toggle('active', chosenDuration === idx);
  });
}

function escapeHtml(s){ return String(s||'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

function hexToRgba(hex,alpha){
  const h = hex.replace('#','');
  const bigint = parseInt(h.length===3? h.split('').map(ch=>ch+ch).join('') : h,16);
  const r = (bigint >> 16) & 255; const g = (bigint >> 8) & 255; const b = bigint & 255;
  return `rgba(${r}, ${g}, ${b}, ${alpha})`;
}

/* ========= Interaction wiring ========= */
airSearch.addEventListener('input', e=>{ searchQuery = e.target.value.trim(); renderAirGrid(); });

document.getElementById('clearFilter').addEventListener('click', ()=>{
  searchQuery = ''; airSearch.value=''; chosenAirline = null; chosenDuration = null; renderAllLists(); updateActiveState();
});
document.getElementById('generateBtn').addEventListener('click', ()=> {
  log('Generate pressed — demo action');
});

document.getElementById('tabRoutes').addEventListener('click', ()=> {
  document.getElementById('tabRoutes').classList.add('active');
  document.getElementById('tabGenerate').classList.remove('active');
  document.getElementById('tabFleet').classList.remove('active');
});
document.getElementById('tabFleet').addEventListener('click', ()=> {
  document.getElementById('tabFleet').classList.add('active');
  document.getElementById('tabGenerate').classList.remove('active');
  document.getElementById('tabRoutes').classList.remove('active');
});
document.getElementById('tabGenerate').addEventListener('click', ()=> {
  document.getElementById('tabGenerate').classList.add('active');
  document.getElementById('tabRoutes').classList.remove('active');
  document.getElementById('tabFleet').classList.remove('active');
});

/* logging helper */
function log(msg){ const line = document.createElement('div'); line.className='kv'; line.textContent = `${new Date().toLocaleTimeString()} — ${msg}`; logEl.prepend(line); }

/* ========= Initial render ========= */
function renderAllLists(){
  renderAirGrid();
  renderDurations();
  renderRoutes();
  renderFleet();
}
renderAllLists();
</script>
</body>
</html>
